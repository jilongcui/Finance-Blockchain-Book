# 隐私计算技术PrimiHub

隐私计算主要作用是保护数据在应用过程中的隐私安全。而PrimiHub是由密码学专家团队大招的开源隐私计算平台。

### 隐私计算

数据流动起来才可以创造更大的价值，随着数字经济持续高速增上，数据的互联互通需求越来越旺盛，大到政府机关数据、公司核心商业数据、小到个人信息。近两年，我国相续出台了《数据安全阀》和《个人隐私保护法》。因此如何让数据安全地流通起来，是一个必须要解决的问题。

隐私计算技术作为**连接数据流通和隐私保护法规的纽带**，实现了 **“数据可用不可见”**。即**在保护数据本身不对外泄露的前提下实现数据分析计算的技术集合**。隐私计算作为数据流通的**重要创新前沿技术**，已经广泛应用于金融、医疗、通信、政务等多个行业。

### PrimiHUB

如果你对隐私计算感兴趣，想近距离体验下隐私计算的魅力，不妨试试 PrimiHub！一款**由密码学专家团队打造的开源隐私计算平台**，它安全可靠、开箱即用、自主研发、功能丰富。

**特性**

- **开源**：完全开源、免费
- **安装简单**：支持 Docker 一键部署
- **开箱即用**：拥有 [Web界面](https://github.com/primihub/primihub-platform)、[命令行](https://docs.primihub.com/docs/category/创建任务) 和 [Python SDK](https://docs.primihub.com/docs/category/python-sdk-client) 多种使用方式
- **功能丰富**：支持隐匿查询、隐私求交、联合统计、数据资源管理等功能
- **灵活配置**：支持自定义扩展语法、语义、安全协议等
- **自主研发**：基于安全多方计算、联邦学习、同态加密、可信计算等隐私计算技术

#### 隐私求交例子

![隐私计算](../images/YinSiJiSuan.gif)

#### 快速开始

推荐使用 Docker 部署 PrimiHub，开启你的隐私计算之旅。

```
# 第一步：下载
git clone https://github.com/primihub/primihub.git
# 第二步：启动容器
cd primihub && docker-compose up -d
# 第三步：进入容器
docker exec -it primihub-node0 bash
# 第四步：执行隐私求交计算
./primihub-cli --task_config_file="example/psi_ecdh_task_conf.json"
I20230616 13:40:10.683375    28 cli.cc:524] all node has finished
I20230616 13:40:10.683745    28 cli.cc:598] SubmitTask time cost(ms): 1419
# 查看结果
cat data/result/psi_result.csv
"intersection_row"
X3
...
```

#### 错误处理

首先我们执行这个之后，报错了，失所docker-compose.yaml的文件格式不对，其实是docker对deponds_on的格式理解有误。

```
ERROR: The Compose file './docker-compose.yml' is invalid because:
services.node0.depends_on contains an invalid type, it should be an array
```

原始的格式：

```
depends_on:
      meta0:
        condition: service_healthy
```

然后你改成

```
depends_on:
      - meta0
      	condition: service_healthy
```

还是报错

```
services.node0.depends_on contains an invalid type, it should be a string
```

后来改成

```
depends_on:
      - meta0
      	# condition: service_healthy
```

也就是隐藏了condition的数据，这是因为docker-compose v3中已经不支持condition配置项了。

#### 执行结果

```
 19:04:51.946027    30 task_config_parser.cc:310] no download cfg, ignore...
 19:04:51.946596    30 cli.cc:127] SubmitTask: TaskId: 100, RequestId: 6ee18241-737e-4e7b-8be2-c3787ebbb309 
 19:04:52.035364    30 cli.cc:38] party count: 2
 19:04:52.286010    30 cli.cc:61] party: "SERVER" status: SUCCESS message: "SUCCESS"
 19:04:52.287707    30 cli.cc:61] party: "CLIENT" status: SUCCESS message: "SUCCESS"
 19:04:52.288556    30 cli.cc:74] all node has finished
 19:04:52.288614    30 cli.cc:76] party name: CLIENT msg: SUCCESS
 19:04:52.288753    30 cli.cc:76] party name: SERVER msg: SUCCESS
 19:04:52.288875    30 task_config_parser.cc:380] SubmitTask time cost(ms): 342

```

查看结果文件

```
root@16364496b089:/app# cat cat data/result/psi_result.csv 
id
X13
X0
X10
X12
X7
X1
X11
X4
X5
X2
X16
X15
X17
X6
X8
X19
X18
X14
X3
X20
X9
```

那么这个示例到底干了什么呢？

在这个例子中，Primihub使用了隐私集合交集（PSI）技术来进行数据处理。具体步骤和作用如下：

1. **任务配置**：命令 `./primihub-cli --task_config_file="example/psi_ecdh_task_conf.json"` 中的 `psi_ecdh_task_conf.json` 是一个任务配置文件，它定义了要执行的任务类型（在此例中是PSI，即Private Set Intersection），参与节点的信息，以及其他可能与数据计算相关的参数。
2. **运行PSI任务**：PSI（Private Set Intersection）是一种加密协议，允许多个方比较各自的数据集，并找出共同元素，而不需要透露自己数据集的其他部分。在此示例中，Primihub通过PSI技术来找出各个参与节点数据集中相同的元素。

通过这个例子中，我们能够理解一个核心的点

* PrimiHub在执行的时候，也是需要多方参与，共同计算的，就类似区块链技术里的各个节点的概念
* 解决的核心是在不暴露自己数据的情况下完成数据的计算。



### 隐私计算技术

那么到底什么是隐私计算技术呢？

Primihub是一个开源项目，致力于提供隐私保护的大数据分析和计算平台。它结合了多种先进技术，如联邦学习、差分隐私和多方安全计算，以实现数据的安全共享和协作分析。这个项目的目标是允许多个组织在不共享原始数据的情况下，共同构建模型或进行数据分析，从而保护各自的数据隐私。

Primihub通过使用联邦学习、多方安全计算和差分隐私等技术，使得多方可以在不分享原始数据的情况下进行协作。这意味着各方可以共同参与模型训练或数据分析，而无需暴露彼此的数据。

具体来说：

1. **联邦学习**：允许多个参与者分别在本地数据上训练模型，然后只共享模型参数而不是数据本身，以构建一个全局模型。
2. **多方安全计算（MPC）**：确保多个参与者可以共同计算函数的结果，而不需要透露其输入信息。每个参与者只获得与最终结果有关的信息。
3. **差分隐私**：通过在数据中引入噪声来保护个人隐私，从而即使对方看到了一些分析结果，也无法推断出个体数据。

这些技术结合在一起，使得Primihub能够提供一个安全的平台，支持多方协作和数据分析，同时严格保护各自的数据隐私。

### PrimiHub提供的隐私计算的方案

Primihub作为一个综合性的平台，提供了多种隐私保护计算方案，以满足不同场景下的数据协作需求。除了PSI之外，Primihub主要提供以下几种隐私计算方案：

1. **联邦学习（Federated Learning）**：
   - 允许多个参与者在本地数据上独立训练模型，然后共享模型参数或梯度，而不是数据本身，从而构建一个全局模型。
2. **多方安全计算（Secure Multi-party Computation, MPC）**：
   - 允许多个参与方共同计算一个函数的结果，而不暴露各自的输入数据。这通常使用加密技术来确保参与者只获得结果，而无法获知其他人的输入。
3. **差分隐私（Differential Privacy）**：
   - 通过引入噪声来保护个人数据，从而即使进行数据分析，也难以逆推出个体信息。差分隐私确保统计结果不会泄露单个用户的数据。
4. **同态加密（Homomorphic Encryption）**：
   - 允许直接对加密数据进行操作，而得到的结果也是加密形式。在解密之后，得到的是与在未加密数据上执行相同操作的结果一致。这种方案能够支持复杂的数据处理任务。
5. **混合隐私方法**：
   - 将上述技术结合使用，根据具体业务场景和安全需求选择适当的组合，以实现更高效和灵活的隐私保护。

这些方案可以单独使用，也可以组合起来以应对不同类型的数据协作任务，帮助企业和组织在遵循法律法规的同时，实现有效的数据利用。

#### 一些关键术语

这些都是隐私计算方案，每种方案都有其特定的应用场景和技术方法：

1. **PSI（Private Set Intersection）**：
   - 隐私集合求交。这项技术允许参与方找到它们数据集中的公共元素，而不需要暴露各自集合中的其他元素。
2. **PIR（Private Information Retrieval）**：
   - 私密信息检索。允许用户从数据库中获取某条记录，而数据库无法获知用户检索了哪条记录。PIR用于保护用户查询隐私。
3. **MPC（Multi-party Computation）**：
   - 多方安全计算。使多个方能够共同计算一个函数，同时保证每一方的数据输入对其他方保持秘密。
4. **FL（Federated Learning）**：
   - 联邦学习。分布式机器学习方法，参与者在本地数据上独立训练模型，然后共享模型参数以构建全局模型，从而无需交换原始数据。

这些方案都旨在实现安全的数据处理和分析，使得多方能够在不泄露私人数据的前提下，协作完成复杂的数据计算任务。在实际应用中，可以根据具体需求选择合适的方案或组合使用这些技术，以最大化数据利用效率并确保隐私保护

### PrimiHub在区块链金融中的应用

在区块链金融项目中，选择合适的隐私计算方案取决于具体的用例和安全需求。以下是一些建议，这些算法可以单独使用或结合使用，以确保多方交互时的数据隐私和安全：

1. **多方安全计算（MPC）**：
   - 适用于需要多个参与者共同计算某些重要金融指标或进行复杂数学运算而不暴露各自输入数据的场景。MPC确保每个参与者只能看到经过授权的输出结果。
2. **同态加密**：
   - 如果需要在加密状态下对数据执行特定计算，同态加密是一种有效方法。这对区块链上存储的交易数据特别有用，可以在不解密数据的情况下完成必要的计算。
3. **联邦学习（FL）**：
   - 在涉及跨组织合作构建机器学习模型时，联邦学习允许各方本地训练数据并只共享模型参数，从而保护数据隐私。例如，在信用评分或风险管理模型中，各参与银行无需共享客户明细即可协作。
4. **零知识证明（ZKP）**：
   - 特别适用于区块链金融，通过该技术，一方可以向另一方展示其拥有某项信息的真实性，而无需透露实际内容。这对于很多金融交易，如身份验证、资产证明等非常实用。
5. **PSI（Private Set Intersection）**：
   - 可用于金融机构之间需要比较其客户列表以识别重叠客户群体，但又不想泄露全部客户名单时。
6. **差分隐私**：
   - 当处理用户敏感信息且需要发布统计数据时，应引入差分隐私以防止逆向工程用户特定数据。这对于报告市场分析、客户行为趋势等有帮助。

针对区块链金融中的多方交互安全，通常会结合使用上述技术。例如，利用同态加密和多方安全计算来实现复杂智能合约，同时应用零知识证明来增强交易隐私性。选择具体方案时，需要权衡性能、安全性、资源需求和实现复杂度等因素，并根据场景优化解决方案。

#### 结合本项目的案例来分析如何应用隐私计算

参与角色 备注：平台不涉及交易，只涉及供应链金融过程中产生的业务活动，或者相关合同，授信，每一步骤可能 会产生相关的一些佐证合同之类。

1. 核心企业 A（买方）：供应链中的大型企业，负责采购原材料或产品，使用隐私计算验证供应商的账款，确保数据隐私。同时作为借贷方之一，可以基于其应付账款或其他资产向金融机构进行借贷。
2. 供应商企业 B（卖方）：供应链中的中小型企业，提供商品或服务，形成应收账款。利用隐私计算上传交易数据并保护敏感信息。并作为另一借贷方，利用应收账款资产化进行融资。
3. 金融机构 C：提供融资服务的银行或金融机构，基于隐私计算验证核心企业和供应商的应付与应收账款的真实性，进行授信放款，支持双向借贷模式。
4. 开发团队 D：负责智能合约、隐私计算算法的开发和维护。
5. 平台运营方 E：管理供应链金融平台，负责智能合约审核、部署与平台运营，确保平台中的隐私计算和数据安全。

请根据上面案例中描述，来分析如何应用隐私计算。

在这个供应链金融的案例中，隐私计算可以被巧妙地应用于多个关键环节，以确保数据隐私、安全和高效协作。以下是关于如何应用隐私计算的一些分析：

1. **核心企业 A 和 供应商企业 B（买方和卖方）之间的交互**：
   - **多方安全计算（MPC）**可以用于验证账款信息。在不泄露各自完整交易数据的情况下，双方能够通过MPC共同计算彼此认可的应付账款和应收账款金额。
   - **同态加密**允许这些企业加密其合同和交易数据，并在区块链上执行合适的经济活动，如结算或对账，而无需解密敏感信息。
2. **供应商企业 B 和 金融机构 C 的融资交互**：
   - **Private Set Intersection (PSI)**可用于核实供应商企业上传的数据是否与金融机构已有的信息匹配，例如，通过确认订单有效性及合法性来降低风险，而无需披露所有交易记录。
   - **零知识证明 (ZKP)** 可用于保障金融机构C在授信决策过程中只需看到经过验证的信息，而非原始数据。例如，使用ZKP证明某笔应收账款已经生效而不透露具体交易内容。
3. **核心企业 A 和 金融机构 C 的借贷过程**：
   - 基于核心企业提供可用作抵押的应付账款情况，可以应用联邦学习（FL）构建风险评估模型。这样金融机构C就能为不同类型的核心企业制定合适贷款方案，同时保护涉及A和其他客户的数据隐私。
4. **智能合约开发与平台运营管理（由开发团队 D 和 平台运营方 E 实施）**：
   - 开发团队D可以将上述隐私计算技术集成进系统中，并利用以太坊等区块链实现智能合约自动化，确保流程透明且合规。
   - 平台运营方E需要确保部署的智能合约准确、可靠，并且定期审核这些智能合约，以确保它们继续遵循当前法规并符合参与者的数据安全需求。

通过这种方式，每个参与角色都能够安全有效地进行他们在供应链金融中的活动，同时最大限度地保护敏感信息。这不仅增强了信任，还提高了整个系统的效率。
